<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VentasAdmin • Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="admin.css" />
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">Ventas<span>Admin</span></div>
      <nav class="menu">
        <a class="item active" data-section="resumen"><i class="fa-solid fa-house"></i>Resumen</a>
        <a class="item" data-section="ajustes"><i class="fa-solid fa-gear"></i>Ajustes</a>
        <div class="spacer"></div>
        <a class="item" href="login.html"><i class="fa-solid fa-right-from-bracket"></i>Salir</a>
      </nav>
      <div class="foot">Módulo informe ventas</div>
    </aside>

    <main class="content">
      <header class="topbar">
        <div class="periodo-header">
          <div class="periodo" id="periodo">Resumen general de ventas • NOVIEMBRE 2025 • S1</div>
          <select id="monthSelector" class="select month-selector">
            <option value="">Cargando meses...</option>
          </select>
        </div>
        <div class="actions">
          <button id="themeToggle" class="btn ghost floating-toggle" title="Cambiar tema">
            <i class="fa-solid fa-moon"></i><span>Modo</span>
          </button>
          <button id="btnReport" class="btn primary">
            <i class="fa-solid fa-chart-pie"></i>Generar reporte
          </button>
        </div>
      </header>

      <!-- RESUMEN -->
      <div id="section-resumen">
        <section class="grid">
          <div class="card metric">
            <div class="kpi-title">Total mensual</div>
            <div class="kpi-value" id="kpiTotal">---</div>
            <div class="kpi-sub">Ventas del mes</div>
          </div>
          <div class="card metric">
            <div class="kpi-title">Promedio por vendedor</div>
            <div class="kpi-value" id="kpiPromedio">---</div>
            <div class="kpi-sub">Media mensual</div>
          </div>
        </section>

        <section class="card table">
          <div class="card-title"><i class="fa-solid fa-briefcase"></i> Desempeño por vendedor</div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Vendedor</th>
                  <th>S1</th>
                  <th>S2</th>
                  <th>S3</th>
                  <th>S4</th>
                  <th>Total</th>
                </tr>
              </thead>
              <!-- CORREGIDO: ID correcto para que admin.js lo encuentre -->
              <tbody id="tablaVendedores">
                <tr><td colspan="6">Cargando datos...</td></tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="card chart-card">
          <div class="card-title">Evolución semanal (total)</div>
          <div class="chart-wrap">
            <!-- CORREGIDO: Canvas agregado para Chart.js -->
            <canvas id="chartSemanal" width="900" height="360"></canvas>
          </div>
        </section>
      </div>

      <!-- AJUSTES (incluye Vendedores + Periodos) -->
      <div id="section-ajustes" class="hidden">
        <section class="card table">
          <div class="card-title"><i class="fa-solid fa-eye"></i> Permisos por usuario</div>
          <div class="users-controls">
            <input id="userSearch" class="input" type="text" placeholder="Buscar usuario..." />
            <div class="spacer"></div>
          </div>
          <div class="table-wrap">
            <table class="table-vendedores" id="usuariosTable">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Rol</th>
                  <th>Permisos</th>
                </tr>
              </thead>
              <tbody id="usuariosBody">
                <tr><td colspan="3" class="muted">Cargando…</td></tr>
              </tbody>
            </table>
          </div>
          <div class="table-actions">
            <button id="saveAll" class="btn primary">
              <i class="fa-solid fa-floppy-disk"></i>Guardar cambios
            </button>
          </div>
        </section>

        <section class="card">
          <div class="card-title"><i class="fa-solid fa-calendar-week"></i> Meses visibles (año en curso)</div>
          <div id="monthsGrid" class="months-grid"></div>
          <div class="table-actions">
            <button id="btnSavePeriods" class="btn primary">
              <i class="fa-solid fa-floppy-disk"></i>Guardar
            </button>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Cargar Chart.js desde CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <!-- Librería para generar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Tu script personalizado -->
  <script src="admin.js"></script>
</body>
</html>